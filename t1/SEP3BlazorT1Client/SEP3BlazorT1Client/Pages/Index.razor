@inject IResidenceService ResidenceService;
@page "/"
@using SEP3BlazorT1Client.Models
@using SEP3BlazorT1Client.Data
@using Authentication

@inject AuthenticationStateProvider AuthenticationStateProvider
@inject NavigationManager NavigationManager


 <div class="mat-layout-grid">
            <div class="mat-layout-grid-inner">
                <div class="mat-layout-grid-cell"></div>
                <div class="mat-layout-grid-cell mat-layout-grid-cell-span-4">
                    <MatCard class="demo-mat-card">
                        <MatCardContent style="padding: 1rem">
                            <table>
                                <tr>
                                    <td>
                                        <img class="profile-img" style="margin-left: 6em; margin-bottom: 2em" width="120" height="120" src="https://cdn.pixabay.com/photo/2017/03/21/02/00/user-2160923_1280.png" alt="">
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <MatTextField @bind-Value="@email" Label="Email" Outlined="true" Style="margin-left: 3em"></MatTextField>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <MatTextField @bind-Value="@password" Dense="true" Label="Password" Outlined="true" Style="margin-left: 3em;"></MatTextField>
                                    </td>
                                </tr>
                                  <tr>
                                      <td>
                                           <MatButton Raised="true" Style="margin-left: 8em;" OnClick="@(() =>PerformLogin())">Log in</MatButton>
                                      </td>
                                      </tr>
                            </table>
                        </MatCardContent>
                        <MatDivider Inset="true"></MatDivider>
                                <MatCardActions>
                                    <MatButton Link="/registerhost">Don't have an account? register here</MatButton>
                                </MatCardActions>
                            </MatCard>
                </div>
                <div class="mat-layout-grid-cell"></div>
            </div>
        </div>



@code
{
    private string email;
    private string password;
    private string ErrorMessage;

    public async Task PerformLogin()
    {
        Console.WriteLine("Loggin in");
        ErrorMessage = "";
        try
        {
            await ((CustomAuthenticationStateProvider) AuthenticationStateProvider).ValidateLogin(email, password);
            email = "";
            password = "";
            NavigationManager.NavigateTo("/BuildingsOverview");
        } catch (Exception e) {
            ErrorMessage = e.Message;
            Console.WriteLine(e.Message);
        }
    }


}
