@using SEP3BlazorT1Client.Authentication
@inherits LayoutComponentBase
@inject NavigationManager NavigationManager
@inject AuthenticationStateProvider AuthenticationStateProvider
@* <div class="page"> *@
@*     <div class="sidebar"> *@
@*         <NavMenu/> *@
@*     </div> *@
@* *@
@*     <div class="main"> *@
@*         <div class="top-row px-4"> *@
@*             <TopNavMenu/> *@
@*         </div> *@
@* *@
@*         <div class="content"> *@
@*             @Body *@
@*         </div> *@
@*     </div> *@
@* </div> *@




@* New Navigation links will go into MatAppBarSection *@
@* Documentation for MatBlazor can be found at: https://www.matblazor.com/ *@

<MatAppBarContainer>
    <MatAppBar Fixed="true" class="mat-elevation-z4">
        <MatAppBarRow>
            <MatAppBarSection>
                <MatIconButton Icon="menu" @onclick="MenuClicked"></MatIconButton>
                <MatAppBarTitle>VIA BnB</MatAppBarTitle>
            </MatAppBarSection>
            <MatAppBarSection Align="@MatAppBarSectionAlign.End">
                <MatButtonLink class="text-white nav-link mat-elevation-z14" Match="NavLinkMatch.All" href="/" Style="margin-right: 1em;">
                    Home
                </MatButtonLink> 
                <MatButtonLink class="text-white nav-link mat-elevation-z14" Match="NavLinkMatch.All" href="/residences" Style="margin-right: 1em;">
                    Browse
                </MatButtonLink>
                
                <MatButtonLink class="text-white nav-link mat-elevation-z14" href="/registerresidence" Style="margin-right: 1em;">
                    About
                </MatButtonLink>
                <MatButtonLink class="text-white nav-link mat-elevation-z14" href="/RentRequests" Style="margin-right: 1em;">
                    Rent Requests
                </MatButtonLink>
                <MatButtonLink class="text-white nav-link mat-elevation-z14" href="/BecomeGuest" Style="margin-right: 1em;">
                    Become Guest
                </MatButtonLink>
                <MatButtonLink class="text-white nav-link mat-elevation-z14" href="/AdminLogin" Style="margin-right: 1em;">
                    Administration
                </MatButtonLink>
                <MatButton class="text-white nav-link mat-elevation-z14" OnClick="LogOut" Style="margin-right: 1em;">
                    Log out
                </MatButton>
            </MatAppBarSection>
        </MatAppBarRow>
    </MatAppBar>
    
    <MatAppBarContent>
        @* Navigation modal. Opens the side menu *@
        <MatDrawerContainer>
            <MatDrawer @bind-Opened="_opened" Mode="MatDrawerMode.Modal">
                <MatListGroup>
                    <MatListGroupSubHeader Style="margin-top: 1rem">Manage residences</MatListGroupSubHeader>
                    <MatList>
                        <MatListItem Href="/registerresidence" OnClick="@(()=>_opened= !_opened)" >
                            Register New Residence
                        </MatListItem>
                        <MatListItem Href="/hostresidences" OnClick="@(()=>_opened= !_opened)">
                          My Residences
                        </MatListItem>
                        <MatListItem Href="/registerhost" OnClick="@(()=>_opened= !_opened)">
                            Register As Host
                        </MatListItem>
                    
                    </MatList>
                </MatListGroup>
            </MatDrawer>
        </MatDrawerContainer>
            <MatDrawerContent>
                <div class="content-body"> 
                    @Body 
                </div> 
            </MatDrawerContent>
    </MatAppBarContent>
</MatAppBarContainer>

@code
{
    private bool _opened = false;

    private void MenuClicked()
    {
        _opened = !_opened;
    }
    

    private async Task LogOut()
    {
    try
        {
            ((CustomAuthenticationStateProvider) AuthenticationStateProvider).Logout();
            NavigationManager.NavigateTo("/");
        }
        catch (Exception e)
        {
        }
    }
}